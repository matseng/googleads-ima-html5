<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="style.css"/>

    <!-- // <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.js"></script> -->
    <script src='node_modules/jquery/dist/jquery.js'></script>
    <script type="text/javascript" src="ajax_interceptor.js"></script>
    <script type="text/javascript" src="sdk/adsapi.js"></script>
    <script type="text/javascript" src="application.js"></script>
    <script type="text/javascript" src="ads.js"></script>
    <script type="text/javascript" src="video_player.js"></script>


    <script>
    (function(win){
      var ncon = win.console;

      var con = win.console = {
          backlog: []
      };

      for(var k in ncon) {
          if(typeof ncon[k] === 'function') {
              con[k] = (function(fn) {
                  return function() {
                      con.backlog.push([new Date(), fn, arguments]);
                      ncon[fn].apply(ncon, arguments);
                  };
              // })(fn);
              })('log');
          }
      }
    })(window);

      $(function() {
        var codeString = "$.get('http://216.178.47.89/api/1.0/tag/8', function(data) {  \
          alert('Load was performed.');  \
          var httpRequest = new XMLHttpRequest(); \
          httpRequest.open('GET', 'test.html');  \
          httpRequest.send();  \
        });"
        var codeString2 = "var httpRequest = new XMLHttpRequest(); \
          httpRequest.open('GET', 'test.html');  \
          httpRequest.send();"

        var hwStr = 'alert("hello world");'
        // _writeScriptToNewIframe(" ", codeString);
        // _writeScriptToNewIframe(" ", hwStr);

        // var frameDoc = _writeScriptToNewIframe("http://localhost:8000/dist/sugr.min.js?lid=165598", hwStr);
        var frameDoc = _writeScriptToNewIframe(codeString2);

        function _writeScriptToNewIframe(codeStr) {
          var iframe = document.createElement('iframe');
          iframe.id = "sugrFrame";
          iframe.frameBorder = iframe.width = iframe.height = 0;
          // append the new element to the <div id="bucket"></div>
          document.body.appendChild(iframe);


          // create a string to use as a new document object
          var jquery = 'node_modules/jquery/dist/jquery.js'
          var val = '<scr' + 'ipt type="text/javascript" src="'+ jquery +'"></scr' + 'ipt>';
          val += '\n <scr' + 'ipt type="text/javascript" src="ajax_interceptor.js"></scr' + 'ipt>';
          val += '\n <scr' + 'ipt type="text/javascript">' + codeStr + '</scr' + 'ipt>';
          // get a handle on the <iframe>d document (in a cross-browser way)
          var doc = iframe.contentWindow || iframe.contentDocument;
          if (doc.document) {
            doc = doc.document;
          }
          // open, write content to, and close the document
          doc.open();
          doc.write(val);
          doc.close();

          return doc;
        }

      })

    
    </script>

    <!-- GPT Companion Code -->
    <!-- Initialize the tagging library -->
     <script type='text/javascript'>
       var googletag = googletag || {};
       googletag.cmd = googletag.cmd || [];
       (function() {
         var gads = document.createElement('script');
         gads.async = true;
         gads.type = 'text/javascript';
         gads.src = '//www.googletagservices.com/tag/js/gpt.js';
         var node = document.getElementsByTagName('script')[0];
         node.parentNode.insertBefore(gads, node);
       })();
     </script>

     <!-- Register your companion slots -->
     <script type='text/javascript'>
       googletag.cmd.push(function() {
         // Supply YOUR_NETWORK/YOUR_UNIT_PATH in place of 6062/iab_vast_samples.
         googletag.defineSlot('/6062/iab_vast_samples', [728, 90], 'companionDiv')
             .addService(googletag.companionAds())
             .addService(googletag.pubads());
         googletag.companionAds().setRefreshUnfilledSlots(true);
         googletag.pubads().enableVideoAds();
         googletag.enableServices();
       });
     </script>

    <title>IMA HTML5 SDK Advanced Demo</title>
  </head>
  <body>
  <div id="container">
    <header>IMA HTML5 SDK Advanced Demo</header>

    <center>
      <label for="tag">Tag (<span id="sampleLink" class="fakeLink">sample</span>):&nbsp;</label>
      <input type="text" size="75" id="tagText" />
    </center>

    <div id="videoplayer">
      <video id="content">
        <source src="http://rmcdn.2mdn.net/Demo/vast_inspector/android.webm"></source>
        <source src="http://rmcdn.2mdn.net/Demo/vast_inspector/android.mp4"></source>
      </video>
      <div id="adcontainer">
      </div>
      <button id="playpause">&#9654;</button>
      <button id="fullscreen">[&nbsp;&nbsp;]</button>
    </div>

    <!-- Declare a div where you want the companion to appear. Use
          googletag.display() to make sure the ad is displayed. -->
    <div id="companionDiv">
      <script type="text/javascript">
        // Using the command queue to enable asynchronous loading.
        // The unit will not actually display now - it will display when
        // the video player is displaying the ads.
        googletag.cmd.push(function() { googletag.display('companionDiv'); });
      </script>
    </div>

    <div id="console">
    Welcome to IMA HTML5 SDK Demo!
    </div>

    <footer>Copyright (C) 2013 Google Inc.</footer>
  </div>
  <script type="text/javascript">
  var application = null;

  window.onload = function() {
    application = new Application();
  };
  </script>
  </body>
</html>
